function NarrationEditor(n){function u(t,i){n.each(t[0].attributes,function(){var e=this.name,r=this.value,n,u,f;r&&r.indexOf("[")!=-1&&(n=r.split("[")[0],u=r.split("]")[1],n[n.length-1]=="."&&(n=n.substr(0,n.length-1)),f=n+"["+i+"]"+u,t.attr(e,f))})}function r(t){for(var f,r,e=t.find(".narration-item"),i=0;i<e.length;i++)for(f=n(e[i]).find("input,select"),r=0;r<f.length;r++)u(n(f[r]),i)}function f(){var t=n(this).val(),i;t&&(i=t.split(",").join(""),n(this).val(i))}function e(){var i=n(this).val(),t,r;i&&(t=Number(i),isNaN(t)||(r=formatNumber(t),n(this).val(r)))}var t=n(".narration-list"),i;if(t){t.on("click",".close-btn",function(){var t=n(this).parents(".narration-list"),i;return t.find(".narration-item").length==1?(i=n(this).parents(".narration-item"),i.find("input").val(""),i.find("select").val("")):(n(this).parents(".narration-item").remove(),r(t)),t.parents("form").trigger("change"),!1});t.on("click",".add-btn",function(){var t=n(this).parents(".narration-list"),i=t.find(".narration-item:last").clone(),u;return i.find(".notice,.error").remove().end().find(".input-validation-error").removeClass("input-validation-error").end().find(".totallerBinded").removeClass("totallerBinded").end().find(".close-btn").removeClass("totallerBinded").end().find("input").val(""),u=i.find(".formatRupee"),u.focus(f),u.blur(e),t.find(".narration-item:last").after(i),r(t),t.parents("form").trigger("change"),i.find("input:first, select:first").first().focus(),!1});for(i=0;i<t.length;i++)r(n(t[i]))}}window.jQuery&&jQuery(function(){NarrationEditor(jQuery);$(".toggle-narration-btn").on("click",function(){var n=$($(this).attr("href"));return n.hasClass("hide")?n.toggleClass("hide"):n.find('input[value!=""]').length||n.toggleClass("hide"),!1})});